version: '3.8'

services:
  # The Python Backend Service (Proxy)
  backend:
    build: ../src
    restart: unless-stopped
    ports:
      - "5000:5000"
    environment:
      - FLOWISE_API_URL=http://flowise:3000
      # OPTIONAL: You can also pass the ID here
      # - TRIAGE_ID=your-flow-id
    depends_on:
      - flowise

  # The Flowise AI Service
  flowise:
    image: flowiseai/flowise
    restart: unless-stopped
    ports:
      - "3000:3000"
    volumes:
      # This saves your Flowise data in your project folder
      - ../flowise_data:/root/.flowise

  # The React Frontend Service
  frontend:
    build: ../frontend
    restart: unless-stopped
    ports:
      # Your website will be available at http://localhost:8080
      - "8080:80"
    depends_on:
      - backend
